<!DOCTYPE html>
<html lang="en">

<head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.98.0" />


<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/dsrkafuu/dsr-cdn-main@1/images/favicons/dsrca.ico" />



<title>决策树学习 - wudao的博客</title>


<meta name="author" content="DSRKafuU" />


<meta name="description" content="A minimal Hugo theme with nice theme color." />


<meta name="keywords" content="机器学习, algo" />


<meta property="og:title" content="决策树学习" />
<meta name="twitter:title" content="决策树学习" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wudaore.github.io/post/decision-tree/" /><meta property="og:description" content="目录 基本原理 信息熵和信息增益 总结 ps. 1. 基本原理 决策树是一种树形结构，每个内部节点代表一个属性上的判断.每个叶节点代表一种分类结果.它的本质就是基于数据，通过问一系列的问题(if-else)去预测结果。 2." />
<meta name="twitter:description" content="目录 基本原理 信息熵和信息增益 总结 ps. 1. 基本原理 决策树是一种树形结构，每个内部节点代表一个属性上的判断.每个叶节点代表一种分类结果.它的本质就是基于数据，通过问一系列的问题(if-else)去预测结果。 2." /><meta property="og:image" content="https://wudaore.github.io/img/og.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://wudaore.github.io/img/og.png" /><meta property="article:published_time" content="2022-06-05T00:00:00+08:00" /><meta property="article:modified_time" content="2022-06-05T00:00:00+08:00" />


<style>
    @media (prefers-color-scheme: dark) {
        body[data-theme='auto'] img {
            filter: brightness(60%);
        }
    }

    body[data-theme='dark'] img {
        filter: brightness(60%);
    }
</style>




<link rel="stylesheet" href="https://wudaore.github.io/assets/css/fuji.min.css" />








</head>

<body
  data-theme="auto"
  data-theme-auto='true'
  >
    <script data-cfasync="false">
  
  var fujiThemeData = localStorage.getItem('fuji_data-theme');
  
  if (!fujiThemeData) {
    localStorage.setItem('fuji_data-theme', 'auto');
  } else {
    
    if (fujiThemeData !== 'auto') {
      document.body.setAttribute('data-theme', fujiThemeData === 'dark' ? 'dark' : 'light');
    }
  }
</script>

    <header>
    <div class="container-lg clearfix">
        <div class="col-12 header">
            <a class="title-main" href="https://wudaore.github.io/">wudao的博客</a>
            
            <span class="title-sub">钝学累功,不妨精熟</span>
            
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-12 col-md-9 float-left content">
                
<article>
    
    <h2 class="post-item post-title">
        <a href="https://wudaore.github.io/post/decision-tree/">决策树学习</a>
    </h2>
    <div class="post-item post-meta">
        <span><i class="iconfont icon-today-sharp"></i>&nbsp;2022-06-05</span>

<span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;1302 words</span>

<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0">机器学习</a>&nbsp;<a href="/tags/algo">algo</a>&nbsp;</span>

    </div>
    
    <div class="post-content markdown-body">
        <h1 id="目录">目录</h1>
<h4 id="基本原理1"><a href="#1">基本原理</a></h4>
<h4 id="信息熵和信息增益2"><a href="#2">信息熵和信息增益</a></h4>
<h4 id="总结conclusion"><a href="#conclusion">总结</a></h4>
<h4 id="psfinal"><a href="#final">ps.</a></h4>
<h2 id="1-基本原理a-id1a">1. 基本原理<a id="1"></a></h2>
<p>决策树是一种树形结构，每个内部节点代表一个属性上的判断.每个叶节点代表一种分类结果.它的本质就是基于数据，通过问一系列的问题(if-else)去预测结果。</p>
<p><img class="img-zoomable" src="/dtree/1.png" alt="png" />
</p>
<h2 id="2-信息熵和信息增益a-id2a">2. 信息熵和信息增益<a id="2"></a></h2>
<p>所谓熵即混乱程度.越有序熵越低.</p>
<h3 id="21-香农熵">2.1 香农熵</h3>
<p><img class="img-zoomable" src="/dtree/2.png" alt="png" />
</p>
<p>计算代码如下：</p>
<pre><code>def calcShannonEnt(dataSet):
    numEntries = len(dataSet)
    labelCounts = {}
    for featVec in dataSet: #the the number of unique elements and their occurance
        currentLabel = featVec[-1]
        if currentLabel not in labelCounts.keys(): labelCounts[currentLabel] = 0
        labelCounts[currentLabel] += 1
    shannonEnt = 0.0
    for key in labelCounts:
        prob = float(labelCounts[key])/numEntries
        shannonEnt -= prob * log(prob,2) #log base 2
    return shannonEnt

</code></pre>
<h3 id="22-信息增益">2.2 信息增益</h3>
<p>信息增益，即以某特征值划分前后信息熵的差值.特征值A对数据集D的增益<strong>g(D,A) = H(D) - H(D|A)</strong></p>
<p><img class="img-zoomable" src="/dtree/3.png" alt="png" />
</p>
<p><strong>举例 探究某论坛用户流失和性别，活跃度的相关性：</strong></p>
<table>
<thead>
<tr>
<th>编号</th>
<th>性别</th>
<th>活跃度</th>
<th>是否流失</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>男</td>
<td>高</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>女</td>
<td>中</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>男</td>
<td>低</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>女</td>
<td>高</td>
<td>0</td>
</tr>
<tr>
<td>5</td>
<td>男</td>
<td>高</td>
<td>0</td>
</tr>
<tr>
<td>6</td>
<td>男</td>
<td>中</td>
<td>0</td>
</tr>
<tr>
<td>7</td>
<td>男</td>
<td>中</td>
<td>1</td>
</tr>
<tr>
<td>8</td>
<td>女</td>
<td>中</td>
<td>0</td>
</tr>
<tr>
<td>9</td>
<td>女</td>
<td>低</td>
<td>1</td>
</tr>
<tr>
<td>10</td>
<td>女</td>
<td>中</td>
<td>0</td>
</tr>
<tr>
<td>11</td>
<td>女</td>
<td>高</td>
<td>0</td>
</tr>
<tr>
<td>12</td>
<td>男</td>
<td>低</td>
<td>1</td>
</tr>
<tr>
<td>13</td>
<td>女</td>
<td>低</td>
<td>1</td>
</tr>
<tr>
<td>14</td>
<td>男</td>
<td>高</td>
<td>0</td>
</tr>
<tr>
<td>15</td>
<td>男</td>
<td>高</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>整理后的数据如下：</p>
<table>
<thead>
<tr>
<th></th>
<th>positive</th>
<th>negative</th>
<th>汇总</th>
</tr>
</thead>
<tbody>
<tr>
<td>整体</td>
<td>5</td>
<td>10</td>
<td>15</td>
</tr>
<tr>
<td>男</td>
<td>3</td>
<td>5</td>
<td>8</td>
</tr>
<tr>
<td>女</td>
<td>2</td>
<td>5</td>
<td>7</td>
</tr>
<tr>
<td>高活跃</td>
<td>0</td>
<td>6</td>
<td>6</td>
</tr>
<tr>
<td>中活跃</td>
<td>1</td>
<td>4</td>
<td>5</td>
</tr>
<tr>
<td>低活跃</td>
<td>4</td>
<td>0</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>首先计算整体熵.E(S) = -(  5/15 * log(5/15) +  10/15 * log(10/15)  ) = 0.9182</p>
<p>然后计算性别熵.根据条件熵的公式，需要依次计算男性和女性的熵值.</p>
<p>E(male) = -( 3/8 * log(3/8) + 5/8 * log(5/8) ) = 0.9543</p>
<p>E(female) = -( 2/7 * log(2/7) + 5/7 * log(5/7) ) = 0.8631</p>
<p>因此，性别的信息增益GAIN = E(S) - 8/15 * E(male) - 7/15 * E(female) = 0.0064</p>
<p>同理，可以求出活跃度的信息增益GAIN = 0.6776 ，远远大于性别的信息增益.也即活跃度对用户流失的影响比性别大.在特征选择和特征分析的时候要更多的考虑.</p>
<p>表现在决策树上，也即信息增益高的因素在树上会被优先划分.</p>
<h3 id="23-信息增益比">2.3 信息增益比</h3>
<p>不难发现，信息增益会更偏重分类多的属性(如上面的例子，若将编号也算作类别的话，编号的信息增益将会最大，这显然是不合理的.)，因此引入信息增益比.</p>
<p>首先引入属性分裂信息度量H.对于每个属性（性别，是否活跃），都会有若干个可能的取值（性别能取男，女，是否活跃能取活跃，一般，不活跃.）令p(x<sub>i</sub>)为某个取值的占比，属性分裂信息度量的计算公式为：</p>
<p><img class="img-zoomable" src="/dtree/4.png" alt="png" />
</p>
<p>而信息增益比 = 信息增益 / 属性分裂信息度量.</p>
<h3 id="24-基尼增益">2.4 基尼增益.</h3>
<p>与信息增益同样是度量的指标.基尼增益最大的属性作为决策树的根节点</p>
<h4 id="241-基尼值">2.4.1 基尼值</h4>
<p>GiNi(D)代表从数据集D中随机抽取两个样本，计算其不一致的概率.基尼值越小，数据集纯度越高</p>
<p><img class="img-zoomable" src="/dtree/5.png" alt="png" />
</p>
<h4 id="242-基尼指数">2.4.2 基尼指数</h4>
<p>一般选择划分后基尼系数最小的属性为最优划分属性.</p>
<p><img class="img-zoomable" src="/dtree/6.png" alt="png" />
</p>
<p>举例：是否拖欠贷款和是否有房，年收入和婚姻状况的关系.数据表格如下(s代表singal单身，m代表married，已结婚,d表示divorced，已离婚)：</p>
<table>
<thead>
<tr>
<th>编号</th>
<th>是否有房</th>
<th>婚姻状况</th>
<th>年收入</th>
<th>是否拖欠贷款</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>s</td>
<td>125</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>m</td>
<td>100</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>0</td>
<td>s</td>
<td>70</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>m</td>
<td>120</td>
<td>0</td>
</tr>
<tr>
<td>5</td>
<td>0</td>
<td>d</td>
<td>95</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>0</td>
<td>m</td>
<td>60</td>
<td>0</td>
</tr>
<tr>
<td>7</td>
<td>1</td>
<td>d</td>
<td>220</td>
<td>0</td>
</tr>
<tr>
<td>8</td>
<td>0</td>
<td>s</td>
<td>85</td>
<td>1</td>
</tr>
<tr>
<td>9</td>
<td>0</td>
<td>m</td>
<td>75</td>
<td>0</td>
</tr>
<tr>
<td>10</td>
<td>0</td>
<td>s</td>
<td>90</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>与计算信息增益类似，基尼增益需要先算出分类以前的基尼值.然后根据各个属性的不同类别（比如婚姻状况属性就有三个类别），依次计算出他们的基尼值.最后用分类以前的基尼值依次进去[ 概率（这里指的是总概率，比如这个案例中的是否拖欠贷款）* 各个类别的基尼值 ]</p>
<p>以本案例来说，根节点基尼系数为0.42.</p>
<p><img class="img-zoomable" src="/dtree/7.png" alt="png" />
</p>
<p><strong>根据是否有房</strong>，计算基尼系数增益为0.077：</p>
<p><img class="img-zoomable" src="/dtree/8.png" alt="png" />
</p>
<p><strong>婚姻状况</strong>不同于是否有房，其并不是一个是或否的问题.需要根据婚姻状况这个属性的三种类别分别划分数据，计算基尼增益.注意划分后只有某类别与其他类别.计算过程如下：</p>
<p><img class="img-zoomable" src="/dtree/9.png" alt="png" />
</p>
<p><img class="img-zoomable" src="/dtree/10.png" alt="png" />
</p>
<p><img class="img-zoomable" src="/dtree/11.png" alt="png" />
</p>
<p>其中最大的增益为0.12</p>

    </div>
</article>


<div class="license markdown-body">
    <blockquote>
        <p>Unless otherwise noted, the content of this site is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"
               target="_blank">CC BY-NC-SA 4.0</a>.</p>
    </blockquote>
</div>



            </div>
            <aside class="col-12 col-md-3 float-left sidebar">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives/">Archives</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/search/">Search</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
            <li>
                <a href="https://github.com/dsrkafuu" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://twitter.com/dsrkafuu" target="_blank"><span>Twitter</span></a>
            </li>
            
            <li>
                <a href="https://space.bilibili.com/19767474" target="_blank"><span>bilibili</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
            <span>
                <a href="/tags/algo/">algo</a>
            </span>
            
            <span>
                <a href="/tags/aplayer/">aplayer</a>
            </span>
            
            <span>
                <a href="/tags/cjk/">cjk</a>
            </span>
            
            <span>
                <a href="/tags/css/">css</a>
            </span>
            
            <span>
                <a href="/tags/emoji/">emoji</a>
            </span>
            
            <span>
                <a href="/tags/html/">html</a>
            </span>
            
            <span>
                <a href="/tags/linux/">linux</a>
            </span>
            
            <span>
                <a href="/tags/markdown/">markdown</a>
            </span>
            
            <span>
                <a href="/tags/others/">others</a>
            </span>
            
            <span>
                <a href="/tags/test/">test</a>
            </span>
            
            <span>
                <a href="/tags/text/">text</a>
            </span>
            
            <span>
                <a href="/tags/themes/">themes</a>
            </span>
            
            <span>
                <a href="/tags/wtf/">wtf</a>
            </span>
            
            <span>
                <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a>
            </span>
            
        </div>
    </div>
    <div class="sidebar-item sidebar-toc">
        <h3>Table of Contents</h3><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1-基本原理a-id1a">1. 基本原理<a id="1"></a></a></li>
    <li><a href="#2-信息熵和信息增益a-id2a">2. 信息熵和信息增益<a id="2"></a></a>
      <ul>
        <li><a href="#21-香农熵">2.1 香农熵</a></li>
        <li><a href="#22-信息增益">2.2 信息增益</a></li>
        <li><a href="#23-信息增益比">2.3 信息增益比</a></li>
        <li><a href="#24-基尼增益">2.4 基尼增益.</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
</aside>

        </div>
        <div class="btn">
    <div class="btn-menu" id="btn-menu">
        <i class="iconfont icon-grid-sharp"></i>
    </div>
    <div class="btn-toggle-mode">
        <i class="iconfont icon-contrast-sharp"></i>
    </div>
    <div class="btn-scroll-top">
        <i class="iconfont icon-chevron-up-circle-sharp"></i>
    </div>
</div>
<aside class="sidebar-mobile" style="display: none;">
  <div class="sidebar-wrapper">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives/">Archives</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/search/">Search</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
            <li>
                <a href="https://github.com/dsrkafuu" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://twitter.com/dsrkafuu" target="_blank"><span>Twitter</span></a>
            </li>
            
            <li>
                <a href="https://space.bilibili.com/19767474" target="_blank"><span>bilibili</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
            <span>
                <a href="/tags/algo/">algo</a>
            </span>
            
            <span>
                <a href="/tags/aplayer/">aplayer</a>
            </span>
            
            <span>
                <a href="/tags/cjk/">cjk</a>
            </span>
            
            <span>
                <a href="/tags/css/">css</a>
            </span>
            
            <span>
                <a href="/tags/emoji/">emoji</a>
            </span>
            
            <span>
                <a href="/tags/html/">html</a>
            </span>
            
            <span>
                <a href="/tags/linux/">linux</a>
            </span>
            
            <span>
                <a href="/tags/markdown/">markdown</a>
            </span>
            
            <span>
                <a href="/tags/others/">others</a>
            </span>
            
            <span>
                <a href="/tags/test/">test</a>
            </span>
            
            <span>
                <a href="/tags/text/">text</a>
            </span>
            
            <span>
                <a href="/tags/themes/">themes</a>
            </span>
            
            <span>
                <a href="/tags/wtf/">wtf</a>
            </span>
            
            <span>
                <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a>
            </span>
            
        </div>
    </div>
    
    
    
    <div class="sidebar-item sidebar-toc">
        <h3>Table of Contents</h3>
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#1-基本原理a-id1a">1. 基本原理<a id="1"></a></a></li>
    <li><a href="#2-信息熵和信息增益a-id2a">2. 信息熵和信息增益<a id="2"></a></a>
      <ul>
        <li><a href="#21-香农熵">2.1 香农熵</a></li>
        <li><a href="#22-信息增益">2.2 信息增益</a></li>
        <li><a href="#23-信息增益比">2.3 信息增益比</a></li>
        <li><a href="#24-基尼增益">2.4 基尼增益.</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
    
  </div>
</aside>
    </main>

    <footer>
    <div class="container-lg clearfix">
        <div class="col-12 footer">
            
            <span>&copy; 2020-2022
                <a href="https://wudaore.github.io/">DSRKafuU</a>
                 | <a href="https://github.com/dsrkafuu/hugo-theme-fuji">Source code</a> 
                | Powered by <a href="https://github.com/dsrkafuu/hugo-theme-fuji/"
                   target="_blank">Fuji-v2</a> &amp; <a href="https://gohugo.io/"
                                                    target="_blank">Hugo</a> 
            </span>
        </div>
    </div>
</footer>

    
<script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.27.0/components/prism-core.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.27.0/plugins/autoloader/prism-autoloader.min.js"></script>



<script defer src="/assets/js/fuji.min.js"></script>



</body>

</html>
